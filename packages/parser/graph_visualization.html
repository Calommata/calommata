<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Structure Graph Analyzer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" rel="stylesheet" type="text/css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            overflow: hidden;
        }
        .main-container {
            display: flex;
            height: 100vh;
        }
        .graph-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        #network {
            flex: 1;
            width: 100%;
            height: 100%;
        }
        .sidebar {
            width: 350px;
            height: 100vh;
            background: white;
            overflow-y: auto;
            padding: 20px;
            box-shadow: -2px 0 8px rgba(0, 0, 0, 0.1);
            border-right: 1px solid #ddd;
        }
        .detail-panel {
            width: 400px;
            height: 100vh;
            background: white;
            overflow-y: auto;
            padding: 20px;
            box-shadow: -2px 0 8px rgba(0, 0, 0, 0.1);
            border-left: 2px solid #667eea;
        }
        .detail-panel.hidden {
            display: none;
        }
        .panel-header {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }
        .detail-section {
            margin-bottom: 20px;
        }
        .section-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        .section-title::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 4px;
            background: #667eea;
            border-radius: 50%;
            margin-right: 8px;
        }
        .source-code {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            overflow-x: auto;
            max-height: 200px;
        }
        .source-code.empty {
            color: #999;
            font-style: italic;
        }
        .import-list {
            background: #f9f9f9;
            border-left: 3px solid #4facfe;
            padding: 10px;
            border-radius: 4px;
        }
        .import-item {
            padding: 5px 0;
            color: #333;
            font-size: 13px;
        }
        .import-item::before {
            content: '‚Üí ';
            color: #4facfe;
            font-weight: bold;
        }
        .no-imports {
            color: #999;
            font-size: 12px;
            font-style: italic;
        }
        .sidebar h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .node-info {
            background: #f8f9fa;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 6px;
            border-left: 3px solid #667eea;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .node-info:hover {
            background: #e8eaf6;
            transform: translateX(5px);
        }
        .node-info.active {
            background: #e8eaf6;
            border-left-color: #764ba2;
        }
        .node-type {
            display: inline-block;
            padding: 2px 8px;
            background: #667eea;
            color: white;
            border-radius: 3px;
            font-size: 11px;
            margin-right: 5px;
            font-weight: bold;
        }
        .node-name {
            font-weight: 600;
            color: #333;
            margin-top: 5px;
            word-break: break-all;
        }
        .node-lines {
            color: #999;
            font-size: 12px;
            margin-top: 3px;
        }
        .stats {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 13px;
        }
        .stats-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        .stats-item:last-child {
            margin-bottom: 0;
        }
        .stats-label {
            color: #666;
        }
        .stats-value {
            font-weight: bold;
            color: #667eea;
        }
        .legend {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 13px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        .legend-item:last-child {
            margin-bottom: 0;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="graph-container">
            <div id="network"></div>
        </div>
        <div class="sidebar">
            <h3>üìä Statistics</h3>
            <div class="stats">
                <div class="stats-item">
                    <span class="stats-label">Total Nodes:</span>
                    <span class="stats-value">28</span>
                </div>
                <div class="stats-item">
                    <span class="stats-label">Total Edges:</span>
                    <span class="stats-value">34</span>
                </div>
                <div class="stats-item">
                    <span class="stats-label">Modules:</span>
                    <span class="stats-value">1</span>
                </div>
                <div class="stats-item">
                    <span class="stats-label">Classes:</span>
                    <span class="stats-value">6</span>
                </div>
                <div class="stats-item">
                    <span class="stats-label">Functions:</span>
                    <span class="stats-value">20</span>
                </div>
                <div class="stats-item">
                    <span class="stats-label">Imports:</span>
                    <span class="stats-value">1</span>
                </div>
            </div>

            <h3>üé® Legend</h3>
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #667eea;"></div>
                    <span>Module</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #764ba2;"></div>
                    <span>Class</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #f093fb;"></div>
                    <span>Function</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #4facfe;"></div>
                    <span>Import</span>
                </div>
            </div>

            <h3>üìã Nodes</h3>
            <div id="nodesList"></div>
        </div>
        <div class="detail-panel hidden" id="detailPanel">
            <div class="panel-header">üìÑ Node Details</div>
            <div class="detail-section">
                <div class="section-title">Name</div>
                <div id="detailName"></div>
            </div>
            <div class="detail-section">
                <div class="section-title">Type</div>
                <div id="detailType"></div>
            </div>
            <div class="detail-section">
                <div class="section-title">Lines</div>
                <div id="detailLines"></div>
            </div>
            <div class="detail-section" id="importsSection" style="display:none;">
                <div class="section-title">üîó Imports</div>
                <div id="detailImports"></div>
            </div>
            <div class="detail-section" id="dependenciesSection" style="display:none;">
                <div class="section-title">üîÄ Dependencies</div>
                <div id="detailDependencies"></div>
            </div>
            <div class="detail-section" id="sourceSection" style="display:none;">
                <div class="section-title">üìù Source Code</div>
                <pre class="source-code" id="detailSource"></pre>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        const nodesArray = [{"id": "module", "label": "module", "title": "module", "color": "#667eea", "type": "module", "lines": "Lines 0-47", "source_code": "\"\"\"User \ubaa8\ub4c8 - \uc0ac\uc6a9\uc790 \uad00\ub9ac\"\"\"\n\nfrom database import DatabaseConnection, QueryBuilder\n\n\nclass UserManager:\n    \"\"\"\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \uad00\ub9ac\ud558\ub294 \ud074\ub798\uc2a4\"\"\"\n\n    def __init__(self, db_connection: DatabaseConnection):\n        self.db = db_connection\n        self.query_builder = QueryBuilder()\n\n    def get_user(self, user_id: int) -> dict:\n        \"\"\"\uc0ac\uc6a9\uc790 \uc815\ubcf4 \uc870\ud68c\"\"\"\n        query = (\n            self.query_builder.select(\"users\", [\"id\", \"name\", \"email\"])\n            .where(f\"id = {user_id}\")\n            .build()\n        )\n        return self._execute_query(query)\n\n    def create_user(self, name: str, email: str):\n        \"\"\"\uc0c8\ub85c\uc6b4 \uc0ac\uc6a9\uc790 \uc0dd\uc131\"\"\"\n        query = f\"INSERT INTO users (name, email) VALUES ('{name}', '{email}')\"\n        self._execute_query(query)\n\n    def _execute_query(self, query: str):\n        \"\"\"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \ucffc\ub9ac \uc2e4\ud589\"\"\"\n        cursor = self.db.connection.cursor()\n        cursor.execute(query)\n        return cursor.fetchall()\n\n\nclass AuthenticationService:\n    \"\"\"\uc0ac\uc6a9\uc790 \uc778\uc99d \uc11c\ube44\uc2a4\"\"\"\n\n    def __init__(self, user_manager: UserManager):\n        self.user_manager = user_manager\n\n    def authenticate(self, username: str, password: str) -> bool:\n        \"\"\"\uc0ac\uc6a9\uc790 \uc778\uc99d\"\"\"\n        user = self.user_manager.get_user(username)\n        return self._verify_password(password, user)\n\n    def _verify_password(self, password: str, user: dict) -> bool:\n        \"\"\"\ube44\ubc00\ubc88\ud638 \uac80\uc99d\"\"\"\n        return True  # \uc2e4\uc81c\ub85c\ub294 \ud574\uc2f1\ub41c \ube44\ubc00\ubc88\ud638\uc640 \ube44\uad50\n", "imports": [], "dependencies": [], "full_name": "module"}, {"id": "module.APIHandler", "label": "APIHandler", "title": "module.APIHandler", "color": "#764ba2", "type": "class", "lines": "Lines 6-34", "source_code": "class APIHandler:\n    \"\"\"API \uc694\uccad\uc744 \ucc98\ub9ac\ud558\ub294 \ud074\ub798\uc2a4\"\"\"\n\n    def __init__(self, auth_service: AuthenticationService):\n        self.auth_service = auth_service\n\n    def handle_request(self, request: dict) -> dict:\n        \"\"\"API \uc694\uccad \ucc98\ub9ac\"\"\"\n        method = request.get(\"method\")\n        if method == \"login\":\n            return self._handle_login(request)\n        elif method == \"get_user\":\n            return self._handle_get_user(request)\n        return {\"error\": \"Unknown method\"}\n\n    def _handle_login(self, request: dict) -> dict:\n        \"\"\"\ub85c\uadf8\uc778 \uc694\uccad \ucc98\ub9ac\"\"\"\n        username = request.get(\"username\")\n        password = request.get(\"password\")\n\n        if self.auth_service.authenticate(username, password):\n            return {\"status\": \"success\", \"message\": \"Login successful\"}\n        return {\"status\": \"fail\", \"message\": \"Invalid credentials\"}\n\n    def _handle_get_user(self, request: dict) -> dict:\n        \"\"\"\uc0ac\uc6a9\uc790 \uc815\ubcf4 \uc870\ud68c \uc694\uccad \ucc98\ub9ac\"\"\"\n        user_id = request.get(\"user_id\")\n        user = self.auth_service.user_manager.get_user(user_id)\n        return {\"status\": \"success\", \"data\": user}", "imports": [], "dependencies": ["AuthenticationService"], "full_name": "module.APIHandler"}, {"id": "module.AuthenticationService", "label": "AuthenticationService", "title": "module.AuthenticationService", "color": "#764ba2", "type": "class", "lines": "Lines 33-46", "source_code": "class AuthenticationService:\n    \"\"\"\uc0ac\uc6a9\uc790 \uc778\uc99d \uc11c\ube44\uc2a4\"\"\"\n\n    def __init__(self, user_manager: UserManager):\n        self.user_manager = user_manager\n\n    def authenticate(self, username: str, password: str) -> bool:\n        \"\"\"\uc0ac\uc6a9\uc790 \uc778\uc99d\"\"\"\n        user = self.user_manager.get_user(username)\n        return self._verify_password(password, user)\n\n    def _verify_password(self, password: str, user: dict) -> bool:\n        \"\"\"\ube44\ubc00\ubc88\ud638 \uac80\uc99d\"\"\"\n        return True  # \uc2e4\uc81c\ub85c\ub294 \ud574\uc2f1\ub41c \ube44\ubc00\ubc88\ud638\uc640 \ube44\uad50", "imports": [], "dependencies": ["UserManager"], "full_name": "module.AuthenticationService"}, {"id": "module.DatabaseConnection", "label": "DatabaseConnection", "title": "module.DatabaseConnection", "color": "#764ba2", "type": "class", "lines": "Lines 6-20", "source_code": "class DatabaseConnection:\n    \"\"\"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0\uc744 \uad00\ub9ac\ud558\ub294 \ud074\ub798\uc2a4\"\"\"\n\n    def __init__(self, db_path: str):\n        self.db_path = db_path\n        self.connection = None\n\n    def connect(self):\n        \"\"\"\ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc5f0\uacb0\"\"\"\n        self.connection = sqlite3.connect(self.db_path)\n\n    def close(self):\n        \"\"\"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc885\ub8cc\"\"\"\n        if self.connection:\n            self.connection.close()", "imports": [], "dependencies": [], "full_name": "module.DatabaseConnection"}, {"id": "module.QueryBuilder", "label": "QueryBuilder", "title": "module.QueryBuilder", "color": "#764ba2", "type": "class", "lines": "Lines 23-42", "source_code": "class QueryBuilder:\n    \"\"\"SQL \ucffc\ub9ac\ub97c \uc0dd\uc131\ud558\ub294 \ud074\ub798\uc2a4\"\"\"\n\n    def __init__(self):\n        self.query = \"\"\n\n    def select(self, table: str, columns: List[str] = None) -> \"QueryBuilder\":\n        \"\"\"SELECT \ucffc\ub9ac \uc2dc\uc791\"\"\"\n        cols = \", \".join(columns) if columns else \"*\"\n        self.query = f\"SELECT {cols} FROM {table}\"\n        return self\n\n    def where(self, condition: str) -> \"QueryBuilder\":\n        \"\"\"WHERE \uc870\uac74 \ucd94\uac00\"\"\"\n        self.query += f\" WHERE {condition}\"\n        return self\n\n    def build(self) -> str:\n        \"\"\"\ucffc\ub9ac \uc644\uc131\"\"\"\n        return self.query", "imports": [], "dependencies": [], "full_name": "module.QueryBuilder"}, {"id": "module.ResponseFormatter", "label": "ResponseFormatter", "title": "module.ResponseFormatter", "color": "#764ba2", "type": "class", "lines": "Lines 37-48", "source_code": "class ResponseFormatter:\n    \"\"\"API \uc751\ub2f5\uc744 \ud3ec\ub9f7\ud305\ud558\ub294 \ud074\ub798\uc2a4\"\"\"\n\n    @staticmethod\n    def format_json(data: dict) -> str:\n        \"\"\"\ub370\uc774\ud130\ub97c JSON \ubb38\uc790\uc5f4\ub85c \ubcc0\ud658\"\"\"\n        return json.dumps(data, indent=2)\n\n    @staticmethod\n    def format_error(error_message: str, error_code: int = 500) -> dict:\n        \"\"\"\uc5d0\ub7ec \uc751\ub2f5 \uc0dd\uc131\"\"\"\n        return {\"error\": error_message, \"code\": error_code}", "imports": [], "dependencies": [], "full_name": "module.ResponseFormatter"}, {"id": "module.UserManager", "label": "UserManager", "title": "module.UserManager", "color": "#764ba2", "type": "class", "lines": "Lines 5-30", "source_code": "class UserManager:\n    \"\"\"\uc0ac\uc6a9\uc790 \uc815\ubcf4\ub97c \uad00\ub9ac\ud558\ub294 \ud074\ub798\uc2a4\"\"\"\n\n    def __init__(self, db_connection: DatabaseConnection):\n        self.db = db_connection\n        self.query_builder = QueryBuilder()\n\n    def get_user(self, user_id: int) -> dict:\n        \"\"\"\uc0ac\uc6a9\uc790 \uc815\ubcf4 \uc870\ud68c\"\"\"\n        query = (\n            self.query_builder.select(\"users\", [\"id\", \"name\", \"email\"])\n            .where(f\"id = {user_id}\")\n            .build()\n        )\n        return self._execute_query(query)\n\n    def create_user(self, name: str, email: str):\n        \"\"\"\uc0c8\ub85c\uc6b4 \uc0ac\uc6a9\uc790 \uc0dd\uc131\"\"\"\n        query = f\"INSERT INTO users (name, email) VALUES ('{name}', '{email}')\"\n        self._execute_query(query)\n\n    def _execute_query(self, query: str):\n        \"\"\"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \ucffc\ub9ac \uc2e4\ud589\"\"\"\n        cursor = self.db.connection.cursor()\n        cursor.execute(query)\n        return cursor.fetchall()", "imports": [], "dependencies": ["DatabaseConnection"], "full_name": "module.UserManager"}, {"id": "module.import", "label": "import", "title": "module.import", "color": "#4facfe", "type": "import", "lines": "Lines 2-2", "source_code": "from database import DatabaseConnection, QueryBuilder", "imports": ["database"], "dependencies": [], "full_name": "module.import"}, {"id": "module.APIHandler.__init__", "label": "__init__", "title": "module.APIHandler.__init__", "color": "#f093fb", "type": "function", "lines": "Lines 9-10", "source_code": "def __init__(self, auth_service: AuthenticationService):\n        self.auth_service = auth_service", "imports": [], "dependencies": [], "full_name": "module.APIHandler.__init__"}, {"id": "module.APIHandler._handle_get_user", "label": "_handle_get_user", "title": "module.APIHandler._handle_get_user", "color": "#f093fb", "type": "function", "lines": "Lines 30-34", "source_code": "def _handle_get_user(self, request: dict) -> dict:\n        \"\"\"\uc0ac\uc6a9\uc790 \uc815\ubcf4 \uc870\ud68c \uc694\uccad \ucc98\ub9ac\"\"\"\n        user_id = request.get(\"user_id\")\n        user = self.auth_service.user_manager.get_user(user_id)\n        return {\"status\": \"success\", \"data\": user}", "imports": [], "dependencies": [], "full_name": "module.APIHandler._handle_get_user"}, {"id": "module.APIHandler._handle_login", "label": "_handle_login", "title": "module.APIHandler._handle_login", "color": "#f093fb", "type": "function", "lines": "Lines 21-28", "source_code": "def _handle_login(self, request: dict) -> dict:\n        \"\"\"\ub85c\uadf8\uc778 \uc694\uccad \ucc98\ub9ac\"\"\"\n        username = request.get(\"username\")\n        password = request.get(\"password\")\n\n        if self.auth_service.authenticate(username, password):\n            return {\"status\": \"success\", \"message\": \"Login successful\"}\n        return {\"status\": \"fail\", \"message\": \"Invalid credentials\"}", "imports": [], "dependencies": [], "full_name": "module.APIHandler._handle_login"}, {"id": "module.APIHandler.handle_request", "label": "handle_request", "title": "module.APIHandler.handle_request", "color": "#f093fb", "type": "function", "lines": "Lines 12-19", "source_code": "def handle_request(self, request: dict) -> dict:\n        \"\"\"API \uc694\uccad \ucc98\ub9ac\"\"\"\n        method = request.get(\"method\")\n        if method == \"login\":\n            return self._handle_login(request)\n        elif method == \"get_user\":\n            return self._handle_get_user(request)\n        return {\"error\": \"Unknown method\"}", "imports": [], "dependencies": [], "full_name": "module.APIHandler.handle_request"}, {"id": "module.AuthenticationService.__init__", "label": "__init__", "title": "module.AuthenticationService.__init__", "color": "#f093fb", "type": "function", "lines": "Lines 36-37", "source_code": "def __init__(self, user_manager: UserManager):\n        self.user_manager = user_manager", "imports": [], "dependencies": [], "full_name": "module.AuthenticationService.__init__"}, {"id": "module.AuthenticationService._verify_password", "label": "_verify_password", "title": "module.AuthenticationService._verify_password", "color": "#f093fb", "type": "function", "lines": "Lines 44-46", "source_code": "def _verify_password(self, password: str, user: dict) -> bool:\n        \"\"\"\ube44\ubc00\ubc88\ud638 \uac80\uc99d\"\"\"\n        return True  # \uc2e4\uc81c\ub85c\ub294 \ud574\uc2f1\ub41c \ube44\ubc00\ubc88\ud638\uc640 \ube44\uad50", "imports": [], "dependencies": [], "full_name": "module.AuthenticationService._verify_password"}, {"id": "module.AuthenticationService.authenticate", "label": "authenticate", "title": "module.AuthenticationService.authenticate", "color": "#f093fb", "type": "function", "lines": "Lines 39-42", "source_code": "def authenticate(self, username: str, password: str) -> bool:\n        \"\"\"\uc0ac\uc6a9\uc790 \uc778\uc99d\"\"\"\n        user = self.user_manager.get_user(username)\n        return self._verify_password(password, user)", "imports": [], "dependencies": [], "full_name": "module.AuthenticationService.authenticate"}, {"id": "module.DatabaseConnection.__init__", "label": "__init__", "title": "module.DatabaseConnection.__init__", "color": "#f093fb", "type": "function", "lines": "Lines 9-11", "source_code": "def __init__(self, db_path: str):\n        self.db_path = db_path\n        self.connection = None", "imports": [], "dependencies": [], "full_name": "module.DatabaseConnection.__init__"}, {"id": "module.DatabaseConnection.close", "label": "close", "title": "module.DatabaseConnection.close", "color": "#f093fb", "type": "function", "lines": "Lines 17-20", "source_code": "def close(self):\n        \"\"\"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \uc5f0\uacb0 \uc885\ub8cc\"\"\"\n        if self.connection:\n            self.connection.close()", "imports": [], "dependencies": [], "full_name": "module.DatabaseConnection.close"}, {"id": "module.DatabaseConnection.connect", "label": "connect", "title": "module.DatabaseConnection.connect", "color": "#f093fb", "type": "function", "lines": "Lines 13-15", "source_code": "def connect(self):\n        \"\"\"\ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc5f0\uacb0\"\"\"\n        self.connection = sqlite3.connect(self.db_path)", "imports": [], "dependencies": [], "full_name": "module.DatabaseConnection.connect"}, {"id": "module.QueryBuilder.__init__", "label": "__init__", "title": "module.QueryBuilder.__init__", "color": "#f093fb", "type": "function", "lines": "Lines 26-27", "source_code": "def __init__(self):\n        self.query = \"\"", "imports": [], "dependencies": [], "full_name": "module.QueryBuilder.__init__"}, {"id": "module.QueryBuilder.build", "label": "build", "title": "module.QueryBuilder.build", "color": "#f093fb", "type": "function", "lines": "Lines 40-42", "source_code": "def build(self) -> str:\n        \"\"\"\ucffc\ub9ac \uc644\uc131\"\"\"\n        return self.query", "imports": [], "dependencies": [], "full_name": "module.QueryBuilder.build"}, {"id": "module.QueryBuilder.select", "label": "select", "title": "module.QueryBuilder.select", "color": "#f093fb", "type": "function", "lines": "Lines 29-33", "source_code": "def select(self, table: str, columns: List[str] = None) -> \"QueryBuilder\":\n        \"\"\"SELECT \ucffc\ub9ac \uc2dc\uc791\"\"\"\n        cols = \", \".join(columns) if columns else \"*\"\n        self.query = f\"SELECT {cols} FROM {table}\"\n        return self", "imports": [], "dependencies": [], "full_name": "module.QueryBuilder.select"}, {"id": "module.QueryBuilder.where", "label": "where", "title": "module.QueryBuilder.where", "color": "#f093fb", "type": "function", "lines": "Lines 35-38", "source_code": "def where(self, condition: str) -> \"QueryBuilder\":\n        \"\"\"WHERE \uc870\uac74 \ucd94\uac00\"\"\"\n        self.query += f\" WHERE {condition}\"\n        return self", "imports": [], "dependencies": [], "full_name": "module.QueryBuilder.where"}, {"id": "module.ResponseFormatter.format_error", "label": "format_error", "title": "module.ResponseFormatter.format_error", "color": "#f093fb", "type": "function", "lines": "Lines 46-48", "source_code": "def format_error(error_message: str, error_code: int = 500) -> dict:\n        \"\"\"\uc5d0\ub7ec \uc751\ub2f5 \uc0dd\uc131\"\"\"\n        return {\"error\": error_message, \"code\": error_code}", "imports": [], "dependencies": [], "full_name": "module.ResponseFormatter.format_error"}, {"id": "module.ResponseFormatter.format_json", "label": "format_json", "title": "module.ResponseFormatter.format_json", "color": "#f093fb", "type": "function", "lines": "Lines 41-43", "source_code": "def format_json(data: dict) -> str:\n        \"\"\"\ub370\uc774\ud130\ub97c JSON \ubb38\uc790\uc5f4\ub85c \ubcc0\ud658\"\"\"\n        return json.dumps(data, indent=2)", "imports": [], "dependencies": [], "full_name": "module.ResponseFormatter.format_json"}, {"id": "module.UserManager.__init__", "label": "__init__", "title": "module.UserManager.__init__", "color": "#f093fb", "type": "function", "lines": "Lines 8-10", "source_code": "def __init__(self, db_connection: DatabaseConnection):\n        self.db = db_connection\n        self.query_builder = QueryBuilder()", "imports": [], "dependencies": [], "full_name": "module.UserManager.__init__"}, {"id": "module.UserManager._execute_query", "label": "_execute_query", "title": "module.UserManager._execute_query", "color": "#f093fb", "type": "function", "lines": "Lines 26-30", "source_code": "def _execute_query(self, query: str):\n        \"\"\"\ub370\uc774\ud130\ubca0\uc774\uc2a4 \ucffc\ub9ac \uc2e4\ud589\"\"\"\n        cursor = self.db.connection.cursor()\n        cursor.execute(query)\n        return cursor.fetchall()", "imports": [], "dependencies": [], "full_name": "module.UserManager._execute_query"}, {"id": "module.UserManager.create_user", "label": "create_user", "title": "module.UserManager.create_user", "color": "#f093fb", "type": "function", "lines": "Lines 21-24", "source_code": "def create_user(self, name: str, email: str):\n        \"\"\"\uc0c8\ub85c\uc6b4 \uc0ac\uc6a9\uc790 \uc0dd\uc131\"\"\"\n        query = f\"INSERT INTO users (name, email) VALUES ('{name}', '{email}')\"\n        self._execute_query(query)", "imports": [], "dependencies": [], "full_name": "module.UserManager.create_user"}, {"id": "module.UserManager.get_user", "label": "get_user", "title": "module.UserManager.get_user", "color": "#f093fb", "type": "function", "lines": "Lines 12-19", "source_code": "def get_user(self, user_id: int) -> dict:\n        \"\"\"\uc0ac\uc6a9\uc790 \uc815\ubcf4 \uc870\ud68c\"\"\"\n        query = (\n            self.query_builder.select(\"users\", [\"id\", \"name\", \"email\"])\n            .where(f\"id = {user_id}\")\n            .build()\n        )\n        return self._execute_query(query)", "imports": [], "dependencies": [], "full_name": "module.UserManager.get_user"}];
        const edgesArray = [{"from": "module", "to": "module.import", "label": ""}, {"from": "module", "to": "sqlite3", "label": ""}, {"from": "module", "to": "database", "label": ""}, {"from": "module", "to": "module.AuthenticationService", "label": ""}, {"from": "module", "to": "module.ResponseFormatter", "label": ""}, {"from": "module", "to": "typing", "label": ""}, {"from": "module", "to": "module.APIHandler", "label": ""}, {"from": "module", "to": "module.UserManager", "label": ""}, {"from": "module", "to": "user", "label": ""}, {"from": "module", "to": "json", "label": ""}, {"from": "module", "to": "module.QueryBuilder", "label": ""}, {"from": "module", "to": "module.DatabaseConnection", "label": ""}, {"from": "module.APIHandler", "to": "module.APIHandler.__init__", "label": ""}, {"from": "module.APIHandler", "to": "module.APIHandler._handle_get_user", "label": ""}, {"from": "module.APIHandler", "to": "module.APIHandler.handle_request", "label": ""}, {"from": "module.APIHandler", "to": "module.APIHandler._handle_login", "label": ""}, {"from": "module.ResponseFormatter", "to": "module.ResponseFormatter.format_json", "label": ""}, {"from": "module.ResponseFormatter", "to": "module.ResponseFormatter.format_error", "label": ""}, {"from": "module.DatabaseConnection", "to": "module.DatabaseConnection.connect", "label": ""}, {"from": "module.DatabaseConnection", "to": "module.DatabaseConnection.close", "label": ""}, {"from": "module.DatabaseConnection", "to": "module.DatabaseConnection.__init__", "label": ""}, {"from": "module.QueryBuilder", "to": "module.QueryBuilder.__init__", "label": ""}, {"from": "module.QueryBuilder", "to": "module.QueryBuilder.select", "label": ""}, {"from": "module.QueryBuilder", "to": "module.QueryBuilder.where", "label": ""}, {"from": "module.QueryBuilder", "to": "module.QueryBuilder.build", "label": ""}, {"from": "module.UserManager", "to": "module.UserManager.create_user", "label": ""}, {"from": "module.UserManager", "to": "module.UserManager.__init__", "label": ""}, {"from": "module.UserManager", "to": "module.UserManager._execute_query", "label": ""}, {"from": "module.UserManager", "to": "module.UserManager.get_user", "label": ""}, {"from": "module.UserManager", "to": "module.DatabaseConnection", "label": ""}, {"from": "module.AuthenticationService", "to": "module.UserManager", "label": ""}, {"from": "module.AuthenticationService", "to": "module.AuthenticationService.__init__", "label": ""}, {"from": "module.AuthenticationService", "to": "module.AuthenticationService._verify_password", "label": ""}, {"from": "module.AuthenticationService", "to": "module.AuthenticationService.authenticate", "label": ""}];
        
        const nodesData = new vis.DataSet(nodesArray);
        const edgesData = new vis.DataSet(edgesArray);

        const container = document.getElementById('network');
        const data = {
            nodes: nodesData,
            edges: edgesData
        };

        const options = {
            physics: {
                enabled: true,
                stabilization: {
                    enabled: true,
                    iterations: 300,
                    updateInterval: 50
                },
                barnesHut: {
                    gravitationalConstant: -20000,
                    centralGravity: 0.3,
                    springLength: 150,
                    springConstant: 0.05,
                },
                minVelocity: 0.75
            },
            interaction: {
                hover: true,
                navigationButtons: true,
                keyboard: true,
                zoomView: true,
                dragNodes: true
            },
            nodes: {
                font: {
                    size: 13,
                    color: '#ffffff',
                    face: 'Segoe UI'
                },
                borderWidth: 2,
                borderWidthSelected: 3,
                shadow: {
                    enabled: true,
                    color: 'rgba(0,0,0,0.2)',
                    size: 10,
                    x: 5,
                    y: 5
                }
            },
            edges: {
                smooth: {
                    type: 'continuous'
                },
                color: {
                    color: '#cccccc',
                    highlight: '#667eea'
                },
                font: { size: 11 },
                width: 1.5,
                arrows: {
                    to: { enabled: true, scaleFactor: 0.8 }
                }
            }
        };

        const network = new vis.Network(container, data, options);

        // After stabilization, stop physics so layout stays put
        network.once('stabilizationIterationsDone', function() {
            network.setOptions({ physics: false });
            console.log('Physics stabilized and disabled');
        });

        // ÎÖ∏Îìú ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
        network.on('click', function(params) {
            if (params.nodes.length > 0) {
                const nodeId = params.nodes[0];
                const node = nodesData.get(nodeId);
                highlightNode(nodeId);
                showNodeDetails(node);
            }
        });

        function highlightNode(nodeId) {
            const allNodes = document.querySelectorAll('.node-info');
            allNodes.forEach(n => n.classList.remove('active'));
            const element = document.querySelector(`[data-node-id="${nodeId}"]`);
            if (element) {
                element.classList.add('active');
                element.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }

        function showNodeDetails(node) {
            const detailPanel = document.getElementById('detailPanel');
            document.getElementById('detailName').textContent = node.full_name;
            document.getElementById('detailType').textContent = node.type.toUpperCase();
            document.getElementById('detailLines').textContent = node.lines;
            
            // Import Ï†ïÎ≥¥ ÌëúÏãú
            const importsSection = document.getElementById('importsSection');
            const detailImports = document.getElementById('detailImports');
            if (node.imports && node.imports.length > 0) {
                importsSection.style.display = 'block';
                detailImports.innerHTML = '';
                node.imports.forEach(imp => {
                    const div = document.createElement('div');
                    div.className = 'import-item';
                    div.textContent = imp;
                    detailImports.appendChild(div);
                });
            } else {
                importsSection.style.display = 'none';
            }
            
            // ÌÅ¥ÎûòÏä§ ÏùòÏ°¥ÏÑ± ÌëúÏãú
            const dependenciesSection = document.getElementById('dependenciesSection');
            const detailDependencies = document.getElementById('detailDependencies');
            if (node.dependencies && node.dependencies.length > 0) {
                dependenciesSection.style.display = 'block';
                detailDependencies.innerHTML = '';
                node.dependencies.forEach(dep => {
                    const div = document.createElement('div');
                    div.className = 'import-item';
                    div.style.color = '#764ba2';
                    div.innerHTML = `<strong>‚óÜ</strong> ${dep}`;
                    detailDependencies.appendChild(div);
                });
            } else {
                dependenciesSection.style.display = 'none';
            }
            
            // ÏÜåÏä§ÏΩîÎìú ÌëúÏãú
            const sourceSection = document.getElementById('sourceSection');
            const detailSource = document.getElementById('detailSource');
            if (node.source_code && node.source_code.trim()) {
                sourceSection.style.display = 'block';
                detailSource.textContent = node.source_code;
                detailSource.classList.remove('empty');
            } else {
                sourceSection.style.display = 'block';
                detailSource.textContent = '(No source code)';
                detailSource.classList.add('empty');
            }
            
            detailPanel.classList.remove('hidden');
        }

        // ÎÖ∏Îìú Î™©Î°ù ÏÉùÏÑ±
        const nodesList = document.getElementById('nodesList');
        const sortedNodes = Array.from(nodesData.get()).sort((a, b) => 
            a.label.localeCompare(b.label)
        );

        sortedNodes.forEach(node => {
            const div = document.createElement('div');
            div.className = 'node-info';
            div.setAttribute('data-node-id', node.id);
            div.innerHTML = `
                <span class="node-type">${node.type}</span>
                <div class="node-name">${node.label}</div>
                <div class="node-lines">${node.lines}</div>
            `;
            div.addEventListener('click', () => {
                network.selectNodes([node.id]);
                network.focus(node.id, { scale: 2, animation: true });
                highlightNode(node.id);
                showNodeDetails(node);
            });
            nodesList.appendChild(div);
        });
    </script>
</body>
</html>
